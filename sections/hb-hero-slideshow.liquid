<section class="section hb-hero-lucky">
  <div class="hb-hero" data-hb-hero>
    <div class="hb-hero__track" id="hbHeroTrack-{{ section.id }}">
        {% for block in section.blocks %}
          <article class="hb-hero__slide" {{ block.shopify_attributes }}>
            <div class="hb-hero__copy">
              {% if block.settings.kicker != blank %}
                <div class="hb-hero__kicker">{{ block.settings.kicker | escape }}</div>
              {% endif %}
              <h1 class="hb-hero__title">{{ block.settings.title | escape }}</h1>
              {% if block.settings.text != blank %}
                <p class="hb-hero__text">{{ block.settings.text | escape }}</p>
              {% endif %}
              <div class="hb-hero__cta">
                {% if block.settings.btn_label != blank and block.settings.btn_link != blank %}
                  <a class="hb-hero__button" href="{{ block.settings.btn_link }}">{{ block.settings.btn_label | escape }}</a>
                {% endif %}
              </div>
            </div>

            <div class="hb-hero__media">
              {% if block.settings.image != blank %}
                {{ block.settings.image | image_url: width: 1600 | image_tag: loading: 'lazy', class: 'hb-hero__img' }}
              {% else %}
                <div class="hb-hero__ph">Upload an image</div>
              {% endif %}
            </div>
          </article>
        {% endfor %}
    </div>

    <div class="hb-hero__controls" aria-label="Slide controls" {% if section.blocks.size < 2 %}hidden{% endif %}>
      <button class="hb-hero__arrow" type="button" data-hb-prev aria-label="Previous slide">&lt;</button>
      <div class="hb-hero__dots">
        {% for block in section.blocks %}
          <button class="hb-dot" type="button" data-index="{{ forloop.index0 }}" aria-label="Go to slide {{ forloop.index }}"></button>
        {% endfor %}
      </div>
      <button class="hb-hero__arrow" type="button" data-hb-next aria-label="Next slide">&gt;</button>
      <button class="hb-hero__pause" type="button" data-hb-pause aria-label="Pause autoplay">II</button>
    </div>
  </div>
</section>

<style>
  .hb-hero-lucky {
    background: #f8f7f3;
    border-bottom: 1px solid #e8e1da;
  }

  .hb-hero {
    max-width: 1920px;
    margin: 0 auto;
    position: relative;
  }

  .hb-hero__track {
    position: relative;
    overflow: hidden;
    min-height: 560px;
  }

  .hb-hero__slide {
    display: grid;
    grid-template-columns: 1.05fr 0.95fr;
    align-items: center;
    gap: clamp(20px, 4vw, 64px);
    min-height: 560px;
    padding: 34px clamp(24px, 7vw, 140px) 46px;
    position: relative;
  }

  .hb-hero__copy {
    max-width: 560px;
    z-index: 1;
  }

  .hb-hero__kicker {
    margin-bottom: 10px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    font-size: 0.78rem;
    color: #7f6455;
  }

  .hb-hero__title {
    color: #5b2d17;
    font-size: clamp(2rem, 4.1vw, 4rem);
    line-height: 1.02;
    letter-spacing: -0.01em;
    margin: 0;
    font-family: var(--hb-font-display, Georgia, serif);
  }

  .hb-hero__text {
    margin: 14px 0 0;
    font-size: clamp(1rem, 1.25vw, 1.9rem);
    color: #8a6654;
    max-width: 40ch;
  }

  .hb-hero__cta {
    margin-top: 24px;
  }

  .hb-hero__button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 220px;
    min-height: 50px;
    padding: 12px 30px;
    border-radius: 999px;
    background: #8f0f1c;
    color: #ffe0b9;
    text-decoration: none;
    font-weight: 600;
    letter-spacing: 0.01em;
  }

  .hb-hero__media {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 420px;
  }

  .hb-hero__img {
    width: 100%;
    max-width: 760px;
    height: auto;
    object-fit: contain;
    display: block;
  }

  .hb-hero__ph {
    min-height: 320px;
    min-width: 320px;
    display: grid;
    place-items: center;
    color: #8a6654;
    border: 1px dashed #d5c8be;
    border-radius: 12px;
    padding: 20px;
  }

  .hb-hero__controls {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    min-height: 44px;
    border-top: 1px solid #e8e1da;
    background: #f8f7f3;
  }

  .hb-hero__arrow,
  .hb-hero__pause {
    border: 0;
    background: transparent;
    color: #7f5a48;
    font-size: 18px;
    line-height: 1;
    min-width: 26px;
    min-height: 26px;
    cursor: pointer;
  }

  .hb-hero__dots {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .hb-dot {
    width: 10px;
    height: 10px;
    border-radius: 999px;
    border: 1px solid #9d8476;
    background: transparent;
    cursor: pointer;
    padding: 0;
  }

  .hb-dot.is-active {
    background: #6f3b24;
    border-color: #6f3b24;
  }

  .hb-hero__pause.is-paused {
    opacity: 0.55;
  }

  @media (max-width: 980px) {
    .hb-hero__slide {
      grid-template-columns: 1fr;
      text-align: center;
      min-height: 0;
      padding: 24px 20px 30px;
      gap: 14px;
    }

    .hb-hero__copy {
      margin: 0 auto;
      max-width: 100%;
    }

    .hb-hero__media {
      min-height: 260px;
    }

    .hb-hero__button {
      min-width: 200px;
    }
  }
</style>

<script>
(function(){
  const root = document.getElementById('hbHeroTrack-{{ section.id }}');
  if (!root) return;
  const wrap = root.closest('[data-hb-hero]');
  const slides = Array.from(root.querySelectorAll('.hb-hero__slide'));
  const dots = Array.from(wrap.querySelectorAll('.hb-dot'));
  const prev = wrap.querySelector('[data-hb-prev]');
  const next = wrap.querySelector('[data-hb-next]');
  const pauseBtn = wrap.querySelector('[data-hb-pause]');
  let i = 0;
  let timer = null;
  let autoplayEnabled = {{ section.settings.autoplay | json }};

  function show(idx) {
    i = (idx + slides.length) % slides.length;
    slides.forEach((s, n) => s.style.display = n === i ? 'grid' : 'none');
    dots.forEach((d, n) => d.classList.toggle('is-active', n === i));
  }

  function stopAutoplay() {
    if (!timer) return;
    clearInterval(timer);
    timer = null;
  }

  function startAutoplay() {
    stopAutoplay();
    if (!autoplayEnabled || slides.length < 2) return;
    timer = setInterval(() => show(i + 1), {{ section.settings.autoplay_ms }});
  }

  dots.forEach(d => d.addEventListener('click', () => {
    show(parseInt(d.dataset.index, 10));
    startAutoplay();
  }));

  if (prev) {
    prev.addEventListener('click', () => {
      show(i - 1);
      startAutoplay();
    });
  }

  if (next) {
    next.addEventListener('click', () => {
      show(i + 1);
      startAutoplay();
    });
  }

  if (pauseBtn) {
    pauseBtn.addEventListener('click', () => {
      autoplayEnabled = !autoplayEnabled;
      pauseBtn.classList.toggle('is-paused', !autoplayEnabled);
      pauseBtn.setAttribute('aria-label', autoplayEnabled ? 'Pause autoplay' : 'Resume autoplay');
      if (autoplayEnabled) {
        startAutoplay();
      } else {
        stopAutoplay();
      }
    });
  }

  slides.forEach((s, n) => { if (n !== 0) s.style.display = 'none'; });
  show(0);
  startAutoplay();
})();
</script>

{% schema %}
{
  "name": "HB Hero Slideshow (Y2K)",
  "settings": [
    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    { "type": "range", "id": "autoplay_ms", "label": "Autoplay interval (ms)", "min": 2500, "max": 9000, "step": 500, "default": 4500 }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "text", "id": "kicker", "label": "Kicker", "default": "honey&blush" },
        { "type": "text", "id": "title", "label": "Title", "default": "Clean girl,\nsoft rebellion." },
        { "type": "text", "id": "text", "label": "Text", "default": "Cozy graphic tees with a little bite. Minimal, flirty, slightly unhinged (in a cute way)." },
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "text", "id": "btn_label", "label": "Primary button", "default": "Shop new drop" },
        { "type": "url", "id": "btn_link", "label": "Primary link" },
        { "type": "text", "id": "sub_label", "label": "Secondary button", "default": "See collections" },
        { "type": "url", "id": "sub_link", "label": "Secondary link" },
        { "type": "text", "id": "note", "label": "Small note", "default": "Printed to order â€¢ EU shipping available" }
      ]
    }
  ],
  "max_blocks": 5,
  "presets": [
    { "name": "HB Hero Slideshow (Y2K)", "blocks": [{ "type": "slide" },{ "type": "slide" },{ "type": "slide" }] }
  ]
}
{% endschema %}

