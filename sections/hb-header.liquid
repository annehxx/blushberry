{% comment %}
  honey&blush — Custom Header
  - Announcement bar (optional)
  - Desktop: left menu, centered logo, right icons
  - Mobile: hamburger, centered logo, icons
  - Lightweight drawer menu (no dependencies)
{% endcomment %}

<section class="hb-header-wrap" data-hb-header>
  {% if section.settings.show_announcement %}
    <div class="hb-ann" role="region" aria-label="Announcement">
      <div class="page-width hb-ann__inner">
        <div class="hb-ann__left">
          {% if section.settings.ann_badge != blank %}
            <span class="hb-ann__badge">{{ section.settings.ann_badge | escape }}</span>
          {% endif %}
          <span class="hb-ann__text">{{ section.settings.ann_text | escape }}</span>
        </div>

        {% if section.settings.ann_link_label != blank and section.settings.ann_link_url != blank %}
          <a class="hb-ann__link" href="{{ section.settings.ann_link_url }}">
            {{ section.settings.ann_link_label | escape }}
          </a>
        {% endif %}
      </div>
    </div>
  {% endif %}

  <header class="hb-header" role="banner">
    <div class="page-width hb-header__inner">
      <!-- Left: Desktop menu / Mobile hamburger -->
      <div class="hb-header__left">
        <button class="hb-burger" type="button" aria-label="Open menu" aria-controls="hbDrawer-{{ section.id }}" aria-expanded="false" data-hb-drawer-open>
          <span class="hb-burger__lines" aria-hidden="true"></span>
        </button>

        {% if section.settings.menu != blank %}
          <nav class="hb-nav" aria-label="Primary navigation">
            <ul class="hb-nav__list">
              {% for link in section.settings.menu.links %}
                <li class="hb-nav__item">
                  <a class="hb-nav__link" href="{{ link.url }}">{{ link.title }}</a>
                </li>
              {% endfor %}
            </ul>
          </nav>
        {% endif %}
      </div>

      <!-- Center: Logo -->
      <div class="hb-header__center">
        <a class="hb-logo" href="{{ routes.root_url }}" aria-label="{{ shop.name }}">
          {% if section.settings.logo != blank %}
            {{ section.settings.logo | image_url: width: 480 | image_tag: loading: 'eager', class: 'hb-logo__img', alt: shop.name }}
          {% else %}
            <span class="hb-logo__text">{{ section.settings.logo_text | default: shop.name | escape }}</span>
          {% endif %}
        </a>

        {% if section.settings.tagline != blank %}
          <div class="hb-tagline">{{ section.settings.tagline | escape }}</div>
        {% endif %}
      </div>

      <!-- Right: Icons -->
      <div class="hb-header__right">
        {% if section.settings.show_search %}
          <a class="hb-icon" href="{{ routes.search_url }}" aria-label="Search">
            <span aria-hidden="true">⌕</span>
          </a>
        {% endif %}

        {% if section.settings.show_account and shop.customer_accounts_enabled %}
          <a class="hb-icon" href="{{ routes.account_url }}" aria-label="Account">
            <span aria-hidden="true">☺</span>
          </a>
        {% endif %}

        {% if section.settings.show_cart %}
          <a class="hb-icon hb-cart" href="{{ routes.cart_url }}" aria-label="Cart">
            <span aria-hidden="true">⟡</span>
            {% if cart.item_count > 0 %}
              <span class="hb-cart__bubble" aria-label="{{ cart.item_count }} items in cart">{{ cart.item_count }}</span>
            {% endif %}
          </a>
        {% endif %}
      </div>
    </div>
  </header>

  <!-- Mobile Drawer -->
  <div class="hb-drawer" id="hbDrawer-{{ section.id }}" aria-hidden="true" data-hb-drawer>
    <div class="hb-drawer__backdrop" data-hb-drawer-close></div>
    <div class="hb-drawer__panel" role="dialog" aria-modal="true" aria-label="Menu">
      <div class="hb-drawer__top">
        <div class="hb-drawer__title">
          {% if section.settings.drawer_title != blank %}
            {{ section.settings.drawer_title | escape }}
          {% else %}
            Menu
          {% endif %}
        </div>
        <button class="hb-drawer__close" type="button" aria-label="Close menu" data-hb-drawer-close>✕</button>
      </div>

      {% if section.settings.menu != blank %}
        <nav class="hb-drawer__nav" aria-label="Mobile navigation">
          <ul class="hb-drawer__list">
            {% for link in section.settings.menu.links %}
              <li class="hb-drawer__item">
                <a class="hb-drawer__link" href="{{ link.url }}">{{ link.title }}</a>
              </li>
            {% endfor %}
          </ul>
        </nav>
      {% endif %}

      {% if section.settings.drawer_note != blank %}
        <div class="hb-drawer__note">{{ section.settings.drawer_note | escape }}</div>
      {% endif %}
    </div>
  </div>
</section>

<style>
  :root{
    --hb-cream:#FBF6EF;
    --hb-ink:#16120F;
    --hb-blush:#E8B7C7;
    --hb-lilac:#C9C3FF;
    --hb-chrome:#CFC7D6;
    --hb-radius:18px;
    --hb-border: color-mix(in srgb, var(--hb-ink) 14%, transparent);
    --hb-shadow: 0 14px 40px rgba(0,0,0,.10);
  }

  .hb-header-wrap{ position: relative; z-index: 60; }

  /* Announcement */
  .hb-ann{
    background: linear-gradient(90deg,
      color-mix(in srgb, var(--hb-blush) 35%, transparent),
      color-mix(in srgb, var(--hb-lilac) 28%, transparent),
      color-mix(in srgb, var(--hb-blush) 35%, transparent)
    );
    border-bottom: 1px solid var(--hb-border);
    position: sticky;
    top: 0;
    z-index: 80;
  }
  .hb-ann__inner{
    display:flex; align-items:center; justify-content:space-between;
    gap: 12px;
    padding: 10px 0;
  }
  .hb-ann__left{ display:flex; align-items:center; gap:10px; min-width:0; }
  .hb-ann__badge{
    display:inline-flex;
    padding: .18rem .55rem;
    border-radius:999px;
    border: 1px solid color-mix(in srgb, var(--hb-ink) 18%, transparent);
    background: rgba(255,255,255,.30);
    font-size:.78rem;
    letter-spacing:.10em;
    text-transform:uppercase;
    white-space:nowrap;
  }
  .hb-ann__text{
    font-size:.95rem;
    letter-spacing:.02em;
    opacity:.9;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .hb-ann__link{
    font-size:.95rem;
    text-decoration:none;
    border-bottom: 1px solid color-mix(in srgb, var(--hb-ink) 28%, transparent);
    white-space:nowrap;
    opacity:.9;
  }
  .hb-ann__link:hover{ opacity:1; }

  /* Header */
  .hb-header{
    position: sticky;
    top: {% if section.settings.show_announcement %}44px{% else %}0px{% endif %};
    z-index: 70;
    background: rgba(255,255,255,.28);
    backdrop-filter: blur(14px);
    border-bottom: 1px solid var(--hb-border);
  }
  .hb-header__inner{
    display:grid;
    grid-template-columns: 1fr auto 1fr;
    align-items:center;
    padding: 12px 0;
    gap: 14px;
  }

  /* Left */
  .hb-header__left{ display:flex; align-items:center; gap: 14px; }
  .hb-nav{ display:block; }
  .hb-nav__list{ display:flex; gap: 6px; margin:0; padding:0; list-style:none; }
  .hb-nav__link{
    display:inline-flex;
    align-items:center;
    padding: 10px 12px;
    border-radius: 999px;
    text-decoration:none;
    color: var(--hb-ink);
    letter-spacing:.02em;
    position:relative;
    background: transparent;
    transition: transform .12s ease, background .12s ease;
  }
  .hb-nav__link:hover{
    background: rgba(255,255,255,.28);
    transform: translateY(-1px);
  }
  .hb-nav__link:after{
    content:"";
    position:absolute;
    left: 14px; right: 14px; bottom: 6px;
    height: 1px;
    background: linear-gradient(90deg,
      transparent,
      color-mix(in srgb, var(--hb-blush) 70%, transparent),
      color-mix(in srgb, var(--hb-lilac) 70%, transparent),
      transparent
    );
    opacity: 0;
    transition: opacity .15s ease;
  }
  .hb-nav__link:hover:after{ opacity: 1; }

  /* Center logo */
  .hb-logo{ text-decoration:none; color:var(--hb-ink); display:flex; justify-content:center; }
  .hb-logo__img{ height: {{ section.settings.logo_height }}px; width:auto; display:block; }
  .hb-logo__text{
    font-family: ui-serif, "Iowan Old Style","Palatino Linotype",Palatino,Garamond,Georgia,serif;
    font-size: 1.55rem;
    letter-spacing: -.01em;
  }
  .hb-tagline{
    text-align:center;
    font-size:.82rem;
    letter-spacing:.14em;
    text-transform:uppercase;
    opacity:.72;
    margin-top: 4px;
  }

  /* Right icons */
  .hb-header__right{ display:flex; justify-content:flex-end; align-items:center; gap: 10px; }
  .hb-icon{
    width: 42px; height: 42px;
    display:grid; place-items:center;
    border-radius: 999px;
    border: 1px solid var(--hb-border);
    background: rgba(255,255,255,.22);
    text-decoration:none;
    color: var(--hb-ink);
    box-shadow: 0 10px 22px rgba(0,0,0,.06);
    transition: transform .12s ease, background .12s ease;
    position:relative;
    font-size: 18px;
    line-height: 1;
  }
  .hb-icon:hover{
    transform: translateY(-1px);
    background: rgba(255,255,255,.30);
  }
  .hb-cart__bubble{
    position:absolute;
    top: -6px; right: -6px;
    min-width: 18px; height: 18px;
    padding: 0 6px;
    border-radius: 999px;
    display:grid; place-items:center;
    background: var(--hb-ink);
    color: var(--hb-cream);
    font-size: 12px;
    border: 1px solid color-mix(in srgb, var(--hb-chrome) 30%, transparent);
    box-shadow: 0 10px 22px rgba(0,0,0,.18);
  }

  /* Burger (mobile) */
  .hb-burger{
    width: 42px; height: 42px;
    border-radius: 999px;
    border: 1px solid var(--hb-border);
    background: rgba(255,255,255,.22);
    display:none;
    place-items:center;
    cursor:pointer;
  }
  .hb-burger__lines{
    width: 18px; height: 12px;
    position: relative;
  }
  .hb-burger__lines:before,
  .hb-burger__lines:after{
    content:"";
    position:absolute;
    left:0; right:0;
    height:2px;
    background: var(--hb-ink);
    border-radius: 2px;
  }
  .hb-burger__lines:before{ top:0; }
  .hb-burger__lines:after{ bottom:0; }
  .hb-burger__lines{
    background: var(--hb-ink);
    height:2px;
    border-radius:2px;
  }

  /* Drawer */
  .hb-drawer{ position: fixed; inset: 0; z-index: 90; display:none; }
  .hb-drawer.is-open{ display:block; }
  .hb-drawer__backdrop{ position:absolute; inset:0; background: rgba(0,0,0,.25); }
  .hb-drawer__panel{
    position:absolute; top:0; left:0; bottom:0;
    width: min(420px, 88vw);
    background: rgba(255,255,255,.55);
    backdrop-filter: blur(16px);
    border-right: 1px solid var(--hb-border);
    box-shadow: 20px 0 60px rgba(0,0,0,.18);
    padding: 14px;
    display:flex;
    flex-direction:column;
    gap: 12px;
  }
  .hb-drawer__top{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding: 8px 6px 10px;
    border-bottom: 1px solid var(--hb-border);
  }
  .hb-drawer__title{
    font-family: ui-serif, "Iowan Old Style","Palatino Linotype",Palatino,Garamond,Georgia,serif;
    font-size: 1.2rem;
    letter-spacing: -.01em;
  }
  .hb-drawer__close{
    width: 42px; height: 42px;
    border-radius: 999px;
    border: 1px solid var(--hb-border);
    background: rgba(255,255,255,.25);
    cursor:pointer;
  }
  .hb-drawer__list{ list-style:none; margin:0; padding: 8px 0; display:flex; flex-direction:column; gap: 6px; }
  .hb-drawer__link{
    display:flex;
    padding: 12px 12px;
    border-radius: 14px;
    text-decoration:none;
    color: var(--hb-ink);
    border: 1px solid transparent;
    background: rgba(255,255,255,.18);
  }
  .hb-drawer__link:hover{
    border-color: var(--hb-border);
    background: rgba(255,255,255,.26);
  }
  .hb-drawer__note{
    margin-top:auto;
    padding: 12px;
    border-radius: 14px;
    border: 1px solid var(--hb-border);
    background: rgba(255,255,255,.22);
    opacity:.9;
  }

  /* Responsive */
  @media (max-width: 990px){
    .hb-nav{ display:none; }
    .hb-burger{ display:grid; }
    .hb-header__inner{ grid-template-columns: auto 1fr auto; }
    .hb-logo{ justify-content:center; }
    .hb-tagline{ display:none; }
  }
  @media (max-width: 740px){
    .hb-ann__link{ display:none; }
  }
</style>

<script>
(function(){
  const wrap = document.querySelector('[data-hb-header]');
  if(!wrap) return;

  const drawer = wrap.querySelector('[data-hb-drawer]');
  const openBtn = wrap.querySelector('[data-hb-drawer-open]');
  const closeEls = wrap.querySelectorAll('[data-hb-drawer-close]');

  if(!drawer || !openBtn) return;

  function open(){
    drawer.classList.add('is-open');
    drawer.setAttribute('aria-hidden','false');
    openBtn.setAttribute('aria-expanded','true');
    document.documentElement.style.overflow = 'hidden';
  }
  function close(){
    drawer.classList.remove('is-open');
    drawer.setAttribute('aria-hidden','true');
    openBtn.setAttribute('aria-expanded','false');
    document.documentElement.style.overflow = '';
  }

  openBtn.addEventListener('click', open);
  closeEls.forEach(el => el.addEventListener('click', close));
  document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') close(); });

  // close drawer on navigation
  drawer.querySelectorAll('a').forEach(a => a.addEventListener('click', close));
})();
</script>

{% schema %}
{
  "name": "HB Custom Header",
  "settings": [
    { "type": "image_picker", "id": "logo", "label": "Logo image" },
    { "type": "text", "id": "logo_text", "label": "Logo text (fallback)", "default": "honey&blush" },
    { "type": "range", "id": "logo_height", "label": "Logo height (px)", "min": 20, "max": 64, "step": 2, "default": 34 },

    { "type": "text", "id": "tagline", "label": "Tagline (optional)", "default": "clean girl meets soft rebellion" },

    { "type": "link_list", "id": "menu", "label": "Menu" },

    { "type": "checkbox", "id": "show_search", "label": "Show search icon", "default": true },
    { "type": "checkbox", "id": "show_account", "label": "Show account icon", "default": true },
    { "type": "checkbox", "id": "show_cart", "label": "Show cart icon", "default": true },

    { "type": "checkbox", "id": "show_announcement", "label": "Show announcement bar", "default": true },
    { "type": "text", "id": "ann_badge", "label": "Announcement badge", "default": "NEW DROP" },
    { "type": "text", "id": "ann_text", "label": "Announcement text", "default": "cozy tees ✧ soft menace energy ✧ printed to order" },
    { "type": "text", "id": "ann_link_label", "label": "Announcement link label", "default": "Shop now" },
    { "type": "url", "id": "ann_link_url", "label": "Announcement link URL" },

    { "type": "text", "id": "drawer_title", "label": "Drawer title", "default": "honey&blush" },
    { "type": "text", "id": "drawer_note", "label": "Drawer note", "default": "Printed to order • No overstock • Less waste" }
  ],
  "presets": [
    { "name": "HB Custom Header" }
  ]
}
{% endschema %}